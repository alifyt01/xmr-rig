#!/bin/bash

set -e
set -o pipefail

echo "=================================="
echo "        MADE BY ALIF ğŸš€"
echo "=================================="
echo ""

echo "ğŸ”„ Updating package lists..."
apt update -y

echo "â¬†ï¸ Upgrading installed packages..."
apt upgrade -y

echo "ğŸ“¦ Installing required packages: sudo, bash, curl..."
apt install -y sudo bash curl

echo "ğŸ³ Installing Docker (Stable Channel)..."
curl -fsSL https://get.docker.com | CHANNEL=stable bash

echo "ğŸ”§ Enabling and starting Docker service..."
sudo systemctl enable --now docker

echo "ğŸ“¥ Pulling xmrig Docker image..."
sudo docker pull xmrig/xmrig

echo "ğŸš€ Running xmrig miner container..."
sudo docker run -d --restart unless-stopped --name monero-miner \
    --cpus=12 --memory=16g \
    xmrig/xmrig -o pool.minexmr.com:4444 \
    -u 4546DThmM9XFDzH7Cb2CPfXBdJaLiCKTXGEWrgMFPRhcPP1FaWxUKgei81pFGK4iG172WxCZHEz75JMxzhy8Yb2R8SFX7qz \
    -k

echo ""
echo "âœ… Monero miner is now running in Docker!"
echo ""
echo "========= Usage Commands ========="
echo "Stop mining   : sudo docker stop monero-miner"
echo "Start mining  : sudo docker start monero-miner"
echo "Restart miner : sudo docker restart monero-miner"
echo "View logs     : sudo docker logs -f monero-miner"
echo "Remove miner  : sudo docker rm -f monero-miner"
echo "Check status  : sudo docker ps"
echo "=================================="
echo ""
